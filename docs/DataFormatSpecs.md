# üìã Data Format Specifications

1. `nps_responses.csv` (Raw NPS Survey Data)

**Required Columns:**
| Column | Type | Notes
| ----- | ---- | -----
| date (or Date) | datetime | Survey response date (e.g., '2022-01-15')
| clinic_id (or clinic) | string/int | Clinic identifier (e.g., 'CLINIC_001', 1)
| nps_score | numeric (0-100) | NPS score value

**Optional but recommended columns:**
- Any additional metadata (clinic name, region, department, etc.)

**Example format:**
```bash
date,clinic_id,nps_score
2022-01-15,CLINIC_001,75
2022-01-15,CLINIC_002,82
2022-01-16,CLINIC_001,68
```

**Row count:** 27,000+ rows (individual survey responses)

2. `revenue_by_clinic.csv` (Raw Revenue Data)
Required Columns:

| Column | Type | Notes
| ----- | ---- | -----
| date (or Date) | datetime | Revenue transaction date
| clinic_id (or clinic) | string/int | Must match NPS clinic_id
| revenue | numeric | Revenue amount in R$ (positive values)

**Optional columns:**
- Department, service type, transaction details

**Example format:**
```bash
date,clinic_id,revenue
2022-01-15,CLINIC_001,5000.00
2022-01-15,CLINIC_001,3500.50
2022-01-15,CLINIC_002,7200.00
2022-01-16,CLINIC_001,4800.00
```

**Row count:** Transaction-level data (daily or multiple entries per clinic per day)

3. `combined_nps_revenue.csv` (Output - Generated by Preprocessing)
This is AUTO-GENERATED by the preprocessing notebook. Final columns:

| Column | Generated by | Type | Notes
| ------ | ------------ | ---- | ----- 
| clinic_id | Merge | string/int | Clinic identifier
| year_month | Aggregation | period | Month identifier (e.g., '2022-01')
| nps_mean | Aggregation | float | Average NPS for clinic-month
| nps_median | Aggregation | float | Median NPS for clinic-month
| nps_std | Aggregation | float | Std dev of NPS responses
| nps_responses | Aggregation | int | Count of responses in month
| nps_outliers | Detection | int | Count of outlier responses
| date_nps | Aggregation | datetime | First survey date in month
| revenue_total | Aggregation | float | Total revenue for clinic-month
| revenue_mean | Aggregation | float | Average daily/transaction revenue
| revenue_std | Aggregation | float | Std dev of revenue
| revenue_outliers | Detection | int | Count of outlier transactions
| date_revenue | Aggregation | datetime | First transaction date in month
| nps_change | Derived | float | Month-over-month NPS % change
| revenue_change | Derived | float | Month-over-month revenue % change
| nps_lag1 | Derived | float | Previous month's NPS
| nps_lag3 | Derived | float | 3-months-ago NPS
| revenue_per_response | Derived | float | Revenue efficiency metric

## üéØ Key Requirements Summary

### ‚úÖ Minimum viable dataset:

- At least 3 clinics
- At least 12 months of data
- Both NPS and revenue for all clinics and months

### ‚úÖ Data quality:
- NPS scores: 0-100 range
- Revenue: positive numbers
- Dates in standard format (YYYY-MM-DD)
- `clinic_id` values **must match exactly** between both files

### ‚úÖ Column naming (flexible):
- Date column can be: `date`, `Date`, `survey_date`, `transaction_date`
- Clinic can be: `clinic_id`, `clinic`, `clinic_name` (code will detect automatically)

### ‚ùå What breaks the pipeline:
- Mismatched clinic IDs between files
- Negative revenue values
- NPS scores outside 0-100
- Missing required core columns